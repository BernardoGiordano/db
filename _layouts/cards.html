<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
{% include head.html%}

<body>
	<div class="content">
		{% include nav.html %}

		<main>
			<button onclick="changeTheme()" class="btn btn-primary button btn-change-theme">Change theme</button>

			{% include popup.html %}

			<div class="container-fluid">
				<div class="row pt-5">
					<div class="col-12 main-content mx-auto">
						{{ content }}

						{% if page.description %}
							<div class="alert alert-secondary mb-4">
								{{ page.description }}
							</div>
						{% endif %}
						
						{% if page.system %}
							<noscript><div class="d-none"></noscript>
								<div class="mb-3">
									Sort:
									<button id="sort-title"class="btn btn-outline-secondary" onclick="sort('title')">Title</button>
									<button id="sort-description"class="btn btn-outline-secondary" onclick="sort('description')">Description</button>
									<button id="sort-updated" class="btn btn-outline-secondary" onclick="sort('updated')">Date Updated</button>
									<button id="sort-direction" class="btn btn-outline-secondary float-right" onclick="toggleSortDirection()">Ascending</button>
								</div>
								<div class="input-group mb-3">
										<label for="search" class="input-group-text">Search:</label>
									<input id="search" class="form-control" type="text" placeholder="Search by title or description" onkeyup="search(event.srcElement.value);">
								</div>
							<noscript></div></noscript>
						{% endif %}
						
						{% if page.system == "3ds" %}
							{% assign cards = site["3ds"] %}
						{% elsif page.system == "ds" %}
							{% assign cards = site.ds %}
							{% elsif page.title == "Home" %}
							{% assign cards = site["3ds"] | concat: site.ds | uniq %}
						{% endif %}

					{% assign cards = cards | sort: "updated" | reverse %}

						<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-xl-4" id="card-container">
							{% for app in cards limit: page.limit %}
								{% if page.category == Nil or app.categories contains page.category %}
									<div class="col mb-3">
										<div class="card h-100" data-title="{{ app.title }}" data-description="{{ app.description }}" data-updated="{{ app.updated }}">
											<a class="flex-grow-1" href="{{ app.url }}">
												{% if app.image %}
													<div class="card-header">
														<img class="mx-auto d-block mw-100 card-image" src="{{ app.image }}" alt="{{ app.title }}">
													</div>
												{% endif %}
												<div class="card-body" style="height: 100%;">
													<div>
														<h4 class="card-title text-center">{{ app.title }}</h4>
														
														<p class="card-text">{{ app.description }}</p>
													</div>
												</div>
											</a>
											{% if app.version or app.qr.size == 1 %}
												<div class="card-footer b-0">
													<div class="row">
														<div class="{% if app.qr.size == 1 %}col-10{% else %}col-12{% endif %}">
															<small class="text-muted">
																{% unless page.system %}
																	System: {{ app.systems | join: ", "}}
																	<br>
																{% endunless %}
																{% if app.version %}
																	Version: {{ app.version }}
																{% endif %}
																{% if app.updated %}
																	<br>
																	Last updated: <time datetime="{{ app.updated }}" title="{{ app.updated | date: '%Y-%m-%d at %H:%M' }}">{{ app.updated | date: "%Y-%m-%d" }}</time>
																{% endif %}
															</small>
														</div>
														<div class="col-2">
															{% if app.qr.size == 1 %}
																{% for qr in app.qr %}
																	<p class="text-right">
																		<noscript><a href="{{ qr[1] }}"></noscript>
																			<i class="fa fa-qrcode pointer" aria-hidden="true" onclick="toggleQR('{{ qr[1] }}', '{{ qr[0] }}')"></i>
																		<noscript></a></noscript>
																	</p>
																{% endfor %}
															{% endif %}
														</div>
													</div>
												</div>
											{% endif %}
										</div>
									</div>
								{% endif %}
							{% endfor %}
						</div>
					</div>
				</div>
			</div>
		</main>
	</div>

	{% include footer.html %}

	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>
	<script src="/assets/js/popupQR.js"></script>
	<script src="/assets/js/relativeTime.js"></script>
	<script src="/assets/js/search.js"></script>
	{% if page.system %}
		<script src="/assets/js/sort.js"></script>
	{% endif %}
	<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
	<script>
		window.OneSignal = window.OneSignal || [];
		OneSignal.push(function() {
			OneSignal.init({
			appId: "3f1f8a28-f4c7-4d11-8764-201037e7e61f",
			});
		});
	</script>
</body>
</html>